<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bergerh√∂hle Energy Consumption</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      console.log("Hello world!");
      console.log({{ data_points }});

      datapoints = {{ data_points }}

      google.charts.load("current", {packages:["corechart"]});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('datetime', 'Time of Day');
        data.addColumn('number', 'Energy in W');
        datapoints.forEach(function(data_point){
           data.addRow([new Date(data_point[0]*1000), data_point[1]])
        });

        midnight_today = new Date();
        midnight_today.setHours(0,0,0,0);

        midnight_tomorrow = new Date();
        midnight_tomorrow.setHours(24,0,0,0);

        var options = {
          animation: {
              duration: 2000,
              startup: true
          },
          chartArea: { width: '90%' },
          title: 'Power consumption today',
          legend: { position: 'none' },
          vAxis: { title: 'Power in W' },
          hAxis: {
              title: 'Time',
              format: 'HH:mm',
              minValue: midnight_today,
              maxValue: midnight_tomorrow
          },
        };

        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
</head>
<body>
<h1>Bergerh&ouml;hle Energy Consumption</h1>
This is a frontend prototype and it needs more design work :)<br><br>
Current power consumption: <b>{{current_power}}</b> W<br>
Daily power consumption: <b>{{daily_power}}</b> Wh<br>
Total power consumption: <b>{{'%.2f' % (total_power / 1000)}}</b> kWh
<p>
<div id="chart_div"></div>
</p>
</body>
</html>